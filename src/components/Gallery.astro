---
import { GalleryContextProvider } from "@utils/context/GalleryContext";
import { fetchGalleryInit } from "@utils/pages/gallery";
import { InfiniteGallery } from "./preact/InfiniteGallery";

const params = new URL(Astro.url).searchParams;

const { camera, cursor, film, gallery, lens } = await fetchGalleryInit(params);
---

<GalleryContextProvider
  client:visible
  camera={camera}
  cursor={cursor}
  film={film}
  gallery={gallery}
  lens={lens}
>
  <InfiniteGallery />
</GalleryContextProvider>
